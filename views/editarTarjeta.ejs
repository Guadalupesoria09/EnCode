<%- include('includes/head.ejs') %>
<h1 class="title has-text-centered">EDITAR TARJETA</h1>
<form action="<%= process.env.PATH_ENV %>tarjeta/editarTarjeta" method="POST">
<input type="hidden" name="_csrf" value="<%= csrfToken %>">
<input type="hidden" name="IDTarjeta" value="<%= tarjeta.IDTarjeta %>">
<input type="hidden" id="id" name="id" value="<%= vistas.IDVista %>">
<section class="section">
<div class="container">
    <div class="columns">
        <div class="column is-half">
            <div class="field-container">
                <div class="box">
                    
                    <div class="field">
                        <label class="label">Sellos</label>
                        <div class="control">
                            <input id="Limite" name="Limite" class="input" type="number" value="<%= tarjeta.Limite %>" required>
                        </div>
                    </div>
                    
                   <div class="field">
                       <label class="label" for="NombrePromocion">Promociones</label>
                       <div class="control">
                           <ul>
                               <% for (let promocion of promociones) { %>
                                   <% if (promocion.Activo == 1) { %>
                                       <li>
                                           <%= promocion.NombrePromocion %>
                                       </li>
                                   <% } %>
                               <% } %>
                           </ul>
                       </div>
                   </div>
                            
                    <div class="field">
                        <label class="label">Vigencia</label>
                        <div class="control">
                            <input id="Vigencia" name="Vigencia" class="input" type="date" value="<%= tarjeta.Vigencia %>" required>
                        </div>
                    </div>
                               
                    <div class="control has-text-centered">
                        <input type="submit" class="button is-link" value="ENVIAR">
                    </div>
                </div>
            </div>
            </form>
            <br>

            <div class="control has-text-centered">
                <a href="<%= process.env.PATH_ENV %>promo/promociones" class="button is-link">EDITAR PROMOCIONES</a>
            </div>
        </div>

         <!-- Aquí inicia la segunda columna donde se mostrará la tarjeta y los sellos -->
        <div class="column is-half">
          <div class="container">
            <div class="cardDB">
              <div class="card-innerDB">
                <div class="frontDB" style="background-image: linear-gradient(45deg, <%= vistas.Color %>, <%= vistas.Color %>)">
                    <img src="<%= process.env.PATH_ENV %>uploads/<%= vistas.Logo %>" class="db-img" width="600px">
                    <div class="rowDB" style="font-family: <%= vistas.Font %>">
                    <a class="image is-24x24" href="#">
                        <img src="<%= process.env.PATH_ENV %>settings_tarjeta.png">
                    </a>
                    <p class="text has-text-right has-text-white"><%= vistas.nombreTarjeta %></p>
                    </div>

                  <!-- Aquí se generan dinámicamente los círculos de sellos -->
                    <div class="rowSDB">
                        <% for (let i = 0; i < tarjeta.Limite; i++) { %>
                        <% if (i % 5 === 0 && i !== 0) { %> <!-- Inicia una nueva fila cada 5 sellos -->
                            </div><div class="rowSDB">
                        <% } %>
                        <div id="circle" class="filled-circle"></div> <!-- Círculo lleno -->
                        <% } %>
                    </div>

                    <div class="rowFDB">
                    <div class="left has-text-left">
                        <p class="text has-text-left has-text-white">@usuario</p>
                        <p class="text has-text-left has-text-white">@teléfono</p>
                    </div>
                    <div class="right has-text-right">
                        <p class="text has-text-right has-text-white"><%= vistas.NombreSucursal %></p>
                        <p class="text has-text-right has-text-white"><%= vistas.NumSucursal %></p>
                    </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</form>

<br>
<div class="control has-text-centered">
  <a href="<%= process.env.PATH_ENV %>promo/promociones" class="button is-link">EDITAR PROMOCIONES</a>
</div>

<%- include('includes/foot.ejs') %>
